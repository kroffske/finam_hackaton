# üìä Baseline —Ä–µ—à–µ–Ω–∏–µ ‚Äî Momentum Strategy

> **–§–∞–π–ª**: `scripts/baseline_solution.py`
> **–¢–∏–ø**: Rule-based (–±–µ–∑ ML)
> **–ò–¥–µ—è**: Momentum continuation ‚Äî —Ç—Ä–µ–Ω–¥ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—Å—è

---

## üéØ –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è

**–ì–∏–ø–æ—Ç–µ–∑–∞**: –ï—Å–ª–∏ –∞–∫—Ç–∏–≤ —Ä–æ—Å –ø–æ—Å–ª–µ–¥–Ω–∏–µ N –¥–Ω–µ–π, –æ–Ω –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞—Å—Ç–∏ (momentum continuation).

**–ü—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏:**
- –í—ã—á–∏—Å–ª—è–µ–º **momentum** = –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 –¥–Ω–µ–π
- –ï—Å–ª–∏ momentum > 0 (–∞–∫—Ç–∏–≤ —Ä–æ—Å) ‚Üí –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ–º —Ä–æ—Å—Ç
- –ï—Å–ª–∏ momentum < 0 (–∞–∫—Ç–∏–≤ –ø–∞–¥–∞–ª) ‚Üí –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ–º –ø–∞–¥–µ–Ω–∏–µ

---

## üßÆ –ö–∞–∫ –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è –ø—Ä–∏–∑–Ω–∞–∫–∏

### 1. Momentum (–º–æ–º–µ–Ω—Ç—É–º)

```python
momentum = (close_t / close_{t-5}) - 1
```

**–ü—Ä–∏–º–µ—Ä:**
```python
# 5 –¥–Ω–µ–π –Ω–∞–∑–∞–¥: close = 100
# –°–µ–≥–æ–¥–Ω—è: close = 105
momentum = (105 / 100) - 1 = 0.05 = +5%
```

### 2. Volatility (–≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å)

```python
# –î–Ω–µ–≤–Ω—ã–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏:
daily_returns = close.pct_change()

# –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å = std –∑–∞ 5 –¥–Ω–µ–π:
volatility = daily_returns.rolling(5).std()
```

### 3. Moving Average (—Å–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ)

```python
ma_5 = close.rolling(5).mean()
```

### 4. Distance from MA

```python
distance_from_ma = (close - ma_5) / ma_5
```

---

## üéØ –ö–∞–∫ –¥–µ–ª–∞—é—Ç—Å—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è

Baseline –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–¥–≤–∞ —Ä–∞–∑–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–∞** –¥–ª—è returns –∏ probabilities:

### 1Ô∏è‚É£ –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ (Returns) ‚Äî LINEAR

```python
pred_return_1d = momentum * 0.3
pred_return_20d = momentum * 1.0
```

**–õ–æ–≥–∏–∫–∞:**
- –î–ª—è 1 –¥–Ω—è: momentum –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—Å—è, –Ω–æ **–æ—Å–ª–∞–±–Ω–µ—Ç** (√ó 0.3)
- –î–ª—è 20 –¥–Ω–µ–π: momentum **–Ω–∞–∫–æ–ø–∏—Ç—Å—è** (√ó 1.0)

**–ü—Ä–∏–º–µ—Ä:**
```python
momentum = 0.05  # –†–æ—Å—Ç –Ω–∞ 5% –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 –¥–Ω–µ–π

pred_return_1d = 0.05 * 0.3 = 0.015 = +1.5%  # –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –∑–∞–≤—Ç—Ä–∞
pred_return_20d = 0.05 * 1.0 = 0.05 = +5%    # –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ 20 –¥–Ω–µ–π
```

**–ü–æ—á–µ–º—É linear?**
- –î–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –º–æ–≥—É—Ç –±—ã—Ç—å **–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º–∏**: -20% ... +20%
- –õ–∏–Ω–µ–π–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ **—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∑–Ω–∞–∫** –∏ –≤–µ–ª–∏—á–∏–Ω—É

---

### 2Ô∏è‚É£ –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ (Probabilities) ‚Äî SIGMOID

```python
def sigmoid(x, sensitivity=10):
    return 1 / (1 + np.exp(-sensitivity * x))

pred_prob_up_1d = sigmoid(momentum, sensitivity=10)
pred_prob_up_20d = sigmoid(momentum, sensitivity=5)
```

**–õ–æ–≥–∏–∫–∞:**
- Sigmoid –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç **–ª—é–±–æ–µ —á–∏—Å–ª–æ** –≤ **–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å [0, 1]**
- –ß–µ–º –±–æ–ª—å—à–µ momentum ‚Üí —Ç–µ–º –≤—ã—à–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ä–æ—Å—Ç–∞
- `sensitivity` –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç "–∫—Ä—É—Ç–∏–∑–Ω—É" sigmoid

**–ü—Ä–∏–º–µ—Ä:**
```python
momentum = 0.05  # –†–æ—Å—Ç –Ω–∞ 5%

# –î–ª—è 1d (sensitivity=10):
pred_prob_up_1d = sigmoid(0.05 * 10) = sigmoid(0.5) ‚âà 0.62
# ‚Üí 62% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ä–æ—Å—Ç–∞

# –î–ª—è 20d (sensitivity=5):
pred_prob_up_20d = sigmoid(0.05 * 5) = sigmoid(0.25) ‚âà 0.56
# ‚Üí 56% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ä–æ—Å—Ç–∞
```

**–ü–æ—á–µ–º—É sigmoid?**
1. **–î–∏–∞–ø–∞–∑–æ–Ω [0, 1]** ‚Äî –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏
2. **–ù–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å** ‚Äî –º–∞–ª–µ–Ω—å–∫–∏–π momentum ‚Üí ~0.5, –±–æ–ª—å—à–æ–π ‚Üí ~0 –∏–ª–∏ ~1
3. **–ú–æ–Ω–æ—Ç–æ–Ω–Ω–æ—Å—Ç—å** ‚Äî –±–æ–ª—å—à–µ momentum ‚Üí –≤—Å–µ–≥–¥–∞ –≤—ã—à–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å
4. **S-–æ–±—Ä–∞–∑–Ω–∞—è —Ñ–æ—Ä–º–∞** ‚Äî –º—è–≥–∫–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—ã, –±–µ–∑ —Ä–µ–∑–∫–∏—Ö —Å–∫–∞—á–∫–æ–≤

---

## üìä –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è: Sigmoid —Å —Ä–∞–∑–Ω—ã–º–∏ sensitivity

![Sigmoid Variants](figures/baseline_sigmoid_variants.png)

**–ö–∞–∫ sensitivity –≤–ª–∏—è–µ—Ç –Ω–∞ sigmoid:**
- **sensitivity=5** ‚Üí –ø–æ–ª–æ–≥–∞—è –∫—Ä–∏–≤–∞—è (–º–µ–¥–ª–µ–Ω–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –æ—Ç 0 –∫ 1)
- **sensitivity=10** ‚Üí —Å—Ä–µ–¥–Ω—è—è –∫—Ä—É—Ç–∏–∑–Ω–∞ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è 1d)
- **sensitivity=20** ‚Üí –∫—Ä—É—Ç–∞—è –∫—Ä–∏–≤–∞—è (—Ä–µ–∑–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥)

**–î–ª—è baseline:**
- 1d –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `sensitivity=10` ‚Üí –±–æ–ª–µ–µ —Ä–µ–∑–∫–∞—è —Ä–µ–∞–∫—Ü–∏—è –Ω–∞ momentum
- 20d –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `sensitivity=5` ‚Üí –±–æ–ª–µ–µ –ø–ª–∞–≤–Ω–∞—è (–¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–π —Ç—Ä–µ–Ω–¥ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–µ–µ)

---

## üìä –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è: Linear vs Sigmoid

![Linear vs Sigmoid](figures/baseline_linear_vs_sigmoid.png)

**–ö–ª—é—á–µ–≤—ã–µ –æ—Ç–ª–∏—á–∏—è:**

| Momentum | pred_return (linear √ó 0.3) | pred_prob_up (sigmoid √ó 10) |
|----------|----------------------------|------------------------------|
| -0.10    | -0.030                     | 0.27 (27% —Ä–æ—Å—Ç)              |
| -0.05    | -0.015                     | 0.38 (38% —Ä–æ—Å—Ç)              |
| 0.00     | 0.000                      | 0.50 (50% —Ä–æ—Å—Ç)              |
| +0.05    | +0.015                     | 0.62 (62% —Ä–æ—Å—Ç)              |
| +0.10    | +0.030                     | 0.73 (73% —Ä–æ—Å—Ç)              |

**Linear** (returns):
- –ü—Ä—è–º–∞—è –ª–∏–Ω–∏—è —á–µ—Ä–µ–∑ (0, 0)
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º
- –ü—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª–µ–Ω momentum

**Sigmoid** (probabilities):
- S-–æ–±—Ä–∞–∑–Ω–∞—è –∫—Ä–∏–≤–∞—è
- –í—Å–µ–≥–¥–∞ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [0, 1]
- –ê—Å–∏–º–ø—Ç–æ—Ç—ã: momentum ‚Üí ¬±‚àû ‚Üí prob ‚Üí 0 –∏–ª–∏ 1

---

## üîß Clipping –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏

### –ü—Ä–æ–±–ª–µ–º–∞: —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏

Sigmoid –º–æ–∂–µ—Ç –≤—ã–¥–∞–≤–∞—Ç—å **—ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏** (–±–ª–∏–∑–∫–æ –∫ 0 –∏–ª–∏ 1):

```python
momentum = 0.50  # –û—á–µ–Ω—å —Å–∏–ª—å–Ω—ã–π —Ä–æ—Å—Ç
pred_prob_up = sigmoid(0.50 * 10) = sigmoid(5.0) ‚âà 0.993
# ‚Üí 99.3% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ä–æ—Å—Ç–∞
```

**–ß—Ç–æ –ø–ª–æ—Ö–æ–≥–æ?**
- –ï—Å–ª–∏ –∞–∫—Ç–∏–≤ **—É–ø–∞–ª**, Brier Score = (0 - 0.993)¬≤ = 0.986 ‚Äî **–æ–≥—Ä–æ–º–Ω—ã–π —à—Ç—Ä–∞—Ñ!**
- –ú–æ–¥–µ–ª—å —Å–ª–∏—à–∫–æ–º **—Å–∞–º–æ—É–≤–µ—Ä–µ–Ω–Ω–∞**
- –ü–ª–æ—Ö–∞—è **–∫–∞–ª–∏–±—Ä–æ–≤–∫–∞** (–∑–∞–≤—ã—à–µ–Ω–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å)

### –†–µ—à–µ–Ω–∏–µ: clipping –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π

```python
pred_prob_up_1d = pred_prob_up_1d.clip(0.1, 0.9)
pred_prob_up_20d = pred_prob_up_20d.clip(0.1, 0.9)
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- –í–º–µ—Å—Ç–æ 0.993 ‚Üí 0.9 (–º–∞–∫—Å–∏–º—É–º 90% —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏)
- –í–º–µ—Å—Ç–æ 0.007 ‚Üí 0.1 (–º–∏–Ω–∏–º—É–º 10% —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏)
- –ú–æ–¥–µ–ª—å —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è **—á–µ—Å—Ç–Ω–µ–µ** (–Ω–µ —É—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç 100% —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å)

---

## üìä –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è: –í–ª–∏—è–Ω–∏–µ Clipping –Ω–∞ Brier Score

![Brier vs Clipping](figures/baseline_brier_vs_clipping.png)

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ (—Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ validation set):**

| –°—Ç—Ä–∞—Ç–µ–≥–∏—è | Brier Score 1d | Brier Score 20d |
|-----------|----------------|------------------|
| –ë–µ–∑ clipping | 0.2632 | 0.2535 |
| Clip [0.1, 0.9] | 0.2632 | 0.2535 |
| Clip [0.2, 0.8] | **0.2626** ‚úÖ | 0.2535 |
| Clip [0.05, 0.95] | 0.2632 | 0.2535 |
| Clip [0.15, 0.85] | 0.2631 | 0.2535 |

**–í—ã–≤–æ–¥—ã (–∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ!):**
1. ü§î –î–ª—è **20d** clipping **–Ω–µ –≤–ª–∏—è–µ—Ç** –Ω–∞ Brier Score (–≤—Å–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ: 0.2535)
   - –ü—Ä–∏—á–∏–Ω–∞: sensitivity=5 ‚Üí sigmoid —É–∂–µ –¥–∞—ë—Ç "–º—è–≥–∫–∏–µ" –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [0.2, 0.8]
   - Momentum —Ä–µ–¥–∫–æ –±—ã–≤–∞–µ—Ç —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–º ‚Üí sigmoid —Ä–µ–¥–∫–æ –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ [0.1, 0.9]

2. ‚úÖ –î–ª—è **1d** –Ω–µ–±–æ–ª—å—à–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ —Å Clip [0.2, 0.8]: **0.2626** vs 0.2632
   - –ü—Ä–∏—á–∏–Ω–∞: sensitivity=10 ‚Üí –±–æ–ª–µ–µ —Ä–µ–∑–∫–∞—è sigmoid ‚Üí —á–∞—â–µ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
   - Clipping –Ω–µ–º–Ω–æ–≥–æ —É–ª—É—á—à–∞–µ—Ç –∫–∞–ª–∏–±—Ä–æ–≤–∫—É

3. üìä –†–∞–∑–Ω–∏—Ü–∞ **–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è** (~0.0006) ‚Äî clipping –≤–∞–∂–µ–Ω, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–µ–Ω –¥–ª—è baseline
   - –î–ª—è –±–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π (ML) clipping –¥–∞—ë—Ç –±–æ–ª—å—à–∏–π —ç—Ñ—Ñ–µ–∫—Ç

---

## üìä –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π (Reliability Diagram)

### 1-day horizon:
![Calibration Curve 1d](figures/baseline_calibration_1d.png)

### 20-day horizon:
![Calibration Curve 20d](figures/baseline_calibration_20d.png)

**–ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≥—Ä–∞—Ñ–∏–∫:**
- **–û—Å—å X**: –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ä–æ—Å—Ç–∞ (—Ä–∞–∑–±–∏—Ç–æ –Ω–∞ 10 –±–∏–Ω–æ–≤)
- **–û—Å—å Y**: –†–µ–∞–ª—å–Ω–∞—è –¥–æ–ª—è —Ä–æ—Å—Ç–∞ –≤ —ç—Ç–æ–º –±–∏–Ω–µ
- **–ß—ë—Ä–Ω–∞—è –¥–∏–∞–≥–æ–Ω–∞–ª—å**: –ò–¥–µ–∞–ª—å–Ω–∞—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ (predicted = observed)
- **–°–∏–Ω—è—è –ª–∏–Ω–∏—è**: Baseline –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞
- **–†–∞–∑–º–µ—Ä —Ç–æ—á–∫–∏**: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–º–µ—Ä–æ–≤ –≤ –±–∏–Ω–µ

**–ü—Ä–∏–º–µ—Ä:**
```python
# –ú–æ–¥–µ–ª—å —Å–∫–∞–∑–∞–ª–∞ "70% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ä–æ—Å—Ç–∞" –¥–ª—è 100 —Å–ª—É—á–∞–µ–≤
# –°–∫–æ–ª—å–∫–æ –∏–∑ –Ω–∏—Ö —Ä–µ–∞–ª—å–Ω–æ –≤—ã—Ä–æ—Å–ª–∏?

# –•–æ—Ä–æ—à–∞—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞: ~70 —Å–ª—É—á–∞–µ–≤ –≤—ã—Ä–æ—Å–ª–∏ (70%)
# –ü–ª–æ—Ö–∞—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞: 50 —Å–ª—É—á–∞–µ–≤ (50%) –∏–ª–∏ 90 —Å–ª—É—á–∞–µ–≤ (90%)
```

**Baseline –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ (–∞–Ω–∞–ª–∏–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤):**

**1d (Brier = 0.2632):**
- ‚ö†Ô∏è **–°–ª–∞–±–∞—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞** ‚Äî —Å–∏–Ω—è—è –ª–∏–Ω–∏—è –¥–∞–ª–µ–∫–æ –æ—Ç –¥–∏–∞–≥–æ–Ω–∞–ª–∏
- –ü—Ä–∏ predicted prob = 0.5 ‚Üí observed freq ‚âà 0.45 (—á—É—Ç—å –∑–∞–Ω–∏–∂–µ–Ω–∞)
- –ë–æ–ª—å—à–æ–π —Ä–∞–∑–±—Ä–æ—Å –Ω–∞ –∫—Ä–∞—è—Ö ‚Üí –º–æ–¥–µ–ª—å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É–≤–µ—Ä–µ–Ω–Ω–∞

**20d (Brier = 0.2535):**
- ‚úÖ **–õ—É—á—à–µ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞** —á–µ–º 1d ‚Äî –±–ª–∏–∂–µ –∫ –¥–∏–∞–≥–æ–Ω–∞–ª–∏
- –ë–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Å–≤—è–∑—å –º–µ–∂–¥—É predicted –∏ observed
- Momentum –ª—É—á—à–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–µ

---

## üìä –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π

![Probability Distribution](figures/baseline_prob_distribution.png)

**–ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π (—Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ):**

**1d (–≤–µ—Ä—Ö–Ω–∏–π —Ä—è–¥):**
- **–ë–µ–∑ clipping** (—Å–ª–µ–≤–∞):
  - –û—Å–Ω–æ–≤–Ω–∞—è –º–∞—Å—Å–∞ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [0.35, 0.65]
  - –î–ª–∏–Ω–Ω—ã–µ —Ö–≤–æ—Å—Ç—ã –¥–æ 0.0 –∏ 1.0 (—Ä–µ–¥–∫–æ, –Ω–æ –µ—Å—Ç—å)
  - Mean ‚âà 0.50 (—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤–æ–∫—Ä—É–≥ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏)

- **–° clipping [0.1, 0.9]** (—Å–ø—Ä–∞–≤–∞):
  - –û–±—Ä–µ–∑–∞–Ω—ã —Ö–≤–æ—Å—Ç—ã ‚Üí –ø–∏–∫–∏ –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–∞—Ö 0.1 –∏ 0.9
  - –û—Å–Ω–æ–≤–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å
  - Mean ‚âà 0.50 (clipping –ø–æ—á—Ç–∏ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å—Ä–µ–¥–Ω–µ–µ)

**20d (–Ω–∏–∂–Ω–∏–π —Ä—è–¥):**
- **–ë–µ–∑ clipping** (—Å–ª–µ–≤–∞):
  - –ë–æ–ª–µ–µ —É–∑–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ [0.40, 0.60]
  - –ü–æ—á—Ç–∏ –Ω–µ—Ç —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (sensitivity=5 ‚Üí –ø–æ–ª–æ–≥–∞—è sigmoid)
  - Mean ‚âà 0.50

- **–° clipping [0.1, 0.9]** (—Å–ø—Ä–∞–≤–∞):
  - **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ** no clipping!
  - –ü—Ä–∏—á–∏–Ω–∞: sigmoid —Å sensitivity=5 —Ä–µ–¥–∫–æ –¥–∞—ë—Ç –∑–Ω–∞—á–µ–Ω–∏—è –≤–Ω–µ [0.1, 0.9]
  - –û–±—ä—è—Å–Ω—è–µ—Ç –ø–æ—á–µ–º—É Brier –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –¥–ª—è –≤—Å–µ—Ö clipping —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

**–í—ã–≤–æ–¥:**
- üìä **1d** (sensitivity=10): clipping –æ–±—Ä–µ–∑–∞–µ—Ç ~1-2% —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- üìä **20d** (sensitivity=5): clipping –ø–æ—á—Ç–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (–∑–Ω–∞—á–µ–Ω–∏—è —É–∂–µ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ)

---

## üéì –ü–æ—á–µ–º—É –Ω–µ–ª—å–∑—è –ø—Ä–æ—Å—Ç–æ –≤–∑—è—Ç—å sign(pred_return)?

### ‚ùå –ù–∞–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥:

```python
pred_direction = 1 if pred_return > 0 else 0  # {0, 1}
pred_prob_up = ???  # –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∏–∑ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ 0/1?
```

**–ü—Ä–æ–±–ª–µ–º–∞**: –¢–µ—Ä—è–µ–º **–≥—Ä–∞–¥–∞—Ü–∏—é —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏**!

### ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (baseline):

```python
pred_return = momentum * 0.3  # –ú–æ–∂–µ—Ç –±—ã—Ç—å -0.02, +0.01, +0.05
pred_prob_up = sigmoid(momentum * 10)  # 0.38, 0.52, 0.73
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:**
- `pred_return = +0.001` ‚Üí `prob_up ‚âà 0.51` (—Å–ª–∞–±–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ —Ä–æ—Å—Ç–µ)
- `pred_return = +0.050` ‚Üí `prob_up ‚âà 0.73` (—Å–∏–ª—å–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ —Ä–æ—Å—Ç–µ)

---

## üß™ –ú–µ—Ç—Ä–∏–∫–∏ Baseline –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

```
1-DAY METRICS:
  MAE:        0.016846
  Brier:      0.263079
  DA:         0.4864 (48.64%)

20-DAY METRICS:
  MAE:        0.020005
  Brier:      0.262271
  DA:         0.5123 (51.23%)
```

**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**

**MAE (Mean Absolute Error):**
- 0.016846 –¥–ª—è 1d ‚Üí –≤ —Å—Ä–µ–¥–Ω–µ–º –æ—à–∏–±–∞–µ–º—Å—è –Ω–∞ ¬±1.68% –≤ –ø—Ä–æ–≥–Ω–æ–∑–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
- 0.020005 –¥–ª—è 20d ‚Üí –≤ —Å—Ä–µ–¥–Ω–µ–º –æ—à–∏–±–∞–µ–º—Å—è –Ω–∞ ¬±2.00%

**Brier Score:**
- 0.263 –¥–ª—è –æ–±–æ–∏—Ö –≥–æ—Ä–∏–∑–æ–Ω—Ç–æ–≤
- –ë–ª–∏–∑–∫–æ –∫ 0.25 (random classifier)
- –ï—Å—Ç—å –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —á–µ—Ä–µ–∑ ML

**DA (Directional Accuracy):**
- 48.64% –¥–ª—è 1d ‚Üí —á—É—Ç—å —Ö—É–∂–µ –º–æ–Ω–µ—Ç–∫–∏ (50%)
- 51.23% –¥–ª—è 20d ‚Üí —á—É—Ç—å –ª—É—á—à–µ –º–æ–Ω–µ—Ç–∫–∏
- Momentum –Ω–∞ –∫–æ—Ä–æ—Ç–∫–∏—Ö –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–ª–∞–±–æ

---

## üí° –ö–∞–∫ —É–ª—É—á—à–∏—Ç—å Baseline?

### 1Ô∏è‚É£ Feature Engineering
```python
# –í–º–µ—Å—Ç–æ —Ç–æ–ª—å–∫–æ momentum, –¥–æ–±–∞–≤–∏—Ç—å:
- RSI (Relative Strength Index)
- MACD (Moving Average Convergence Divergence)
- Bollinger Bands
- Volume indicators
- Cross-sectional features (sector momentum)
```

### 2Ô∏è‚É£ Machine Learning
```python
# –ó–∞–º–µ–Ω–∏—Ç—å rule-based –Ω–∞ ML:
from lightgbm import LGBMRegressor, LGBMClassifier

# –î–ª—è returns: regression
model_return = LGBMRegressor(objective='mae')
model_return.fit(X_train, y_return_train)

# –î–ª—è probabilities: classification
model_prob = LGBMClassifier(objective='binary')
model_prob.fit(X_train, y_direction_train)
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ ML:**
- –ù–µ–ª–∏–Ω–µ–π–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
- Feature interactions
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ (–¥–ª—è classification)

### 3Ô∏è‚É£ Calibration
```python
from sklearn.calibration import CalibratedClassifierCV

# Post-hoc –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π
calibrated_model = CalibratedClassifierCV(model, method='isotonic')
calibrated_model.fit(X_train, y_train)
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- –£–ª—É—á—à–µ–Ω–∏–µ Brier Score –Ω–∞ 5-10%
- –õ—É—á—à–∞—è reliability diagram

### 4Ô∏è‚É£ Ensemble
```python
# –ö–æ–º–±–∏–Ω–∞—Ü–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–æ–¥–µ–ª–µ–π:
pred_final = 0.5 * pred_momentum + 0.5 * pred_lgbm

# –ò–ª–∏ weighted average –ø–æ validation performance
```

---

## üìö –°—Å—ã–ª–∫–∏

- **Momentum Strategy**: https://en.wikipedia.org/wiki/Momentum_(finance)
- **Sigmoid Function**: https://en.wikipedia.org/wiki/Sigmoid_function
- **Brier Score**: https://en.wikipedia.org/wiki/Brier_score
- **Calibration**: https://scikit-learn.org/stable/modules/calibration.html

---

## üéØ Takeaways

1. ‚úÖ Baseline –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **momentum continuation** –≥–∏–ø–æ—Ç–µ–∑—É
2. ‚úÖ **Linear** –¥–ª—è returns (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∑–Ω–∞–∫ –∏ –≤–µ–ª–∏—á–∏–Ω—É)
3. ‚úÖ **Sigmoid** –¥–ª—è probabilities (–ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤ [0, 1])
4. ‚úÖ **Clipping [0.1, 0.9]** —É–ª—É—á—à–∞–µ—Ç –∫–∞–ª–∏–±—Ä–æ–≤–∫—É
5. ‚úÖ –≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ (0.01, 0.99) ‚Üí –ø–ª–æ—Ö–æ–π Brier Score
6. ‚úÖ DA ‚âà 50% ‚Üí momentum —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–ª–∞–±–æ –Ω–∞ –∫–æ—Ä–æ—Ç–∫–∏—Ö –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞—Ö
7. ‚úÖ –ï—Å—Ç—å –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —á–µ—Ä–µ–∑ ML
